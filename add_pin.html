<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>Add Pin</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f9; padding: 20px; }
    form { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 8px; }
    input, textarea, select, button { width: 100%; margin: 10px 0; padding: 10px; }
    button { background: #0073e6; color: white; border: none; cursor: pointer; }
    button:hover { background: #005bb5; }
    .msg { margin-top: 15px; font-weight: bold; }
  </style>
</head>
<body>

<h2>Add New Pin</h2>

<form id="pinForm">
  <label for="member">Select Member:</label>
  <select id="member" name="member_id" required>
    <option value="">Loading...</option>
  </select>

  <label for="image_url">Image URL:</label>
  <input type="url" id="image_url" name="image_url" placeholder="https://example.com/image.jpg" required>

  <label for="title">Title:</label>
  <input type="text" id="title" name="title" required>

  <label for="description">Description:</label>
  <textarea id="description" name="description" rows="4"></textarea>

  <button type="submit">Add Pin</button>
</form>

<div class="msg" id="msg"></div>

<script>
// Members list भरना
fetch("https://deepakchauhanxai.xyz/pinterest/list_members.php")
  .then(res => res.json())
  .then(data => {
    const memberSelect = document.getElementById("member");
    memberSelect.innerHTML = "";
    if (data.ok) {
      data.members.forEach(m => {
        let opt = document.createElement("option");
        opt.value = m.id;
        opt.textContent = m.name + " (" + m.username + ")";
        memberSelect.appendChild(opt);
      });
    } else {
      memberSelect.innerHTML = "<option>No members found</option>";
    }
  });

// Form submit करना
document.getElementById("pinForm").addEventListener("submit", function(e) {
  e.preventDefault();

  const payload = {
    member_id: document.getElementById("member").value,
    image_url: document.getElementById("image_url").value,
    title: document.getElementById("title").value,
    description: document.getElementById("description").value
  };

  fetch("https://deepakchauhanxai.xyz/pinterest/add_pin.php", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  })
  .then(res => res.json())
  .then(result => {
    document.getElementById("msg").textContent = result.msg;
    if (result.ok) {
      document.getElementById("msg").style.color = "green";
      document.getElementById("pinForm").reset();
    } else {
      document.getElementById("msg").style.color = "red";
    }
  })
  .catch(err => {
    document.getElementById("msg").textContent = "❌ Network/API error";
    document.getElementById("msg").style.color = "red";
  });
});
</script>

</body>
</html>
