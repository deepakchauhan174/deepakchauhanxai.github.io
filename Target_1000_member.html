<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User Messages Live</title>
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    background: #f0f2f5;
    color: #333;
    transition: background 0.3s, color 0.3s;
  }
  .dark-mode {
    background: #1e1e1e;
    color: #ddd;
  }
  header {
    padding: 15px;
    text-align: center;
    background: linear-gradient(90deg, #007bff, #00bfff);
    color: white;
    font-size: 1.5em;
    font-weight: bold;
  }
  .container {
    max-width: 800px;
    margin: auto;
    padding: 15px;
  }
  .message {
    background: white;
    padding: 12px;
    margin-bottom: 10px;
    border-radius: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    transition: background 0.3s;
  }
  .dark-mode .message {
    background: #2a2a2a;
  }
  .time {
    font-size: 0.8em;
    color: gray;
  }
  .dark-mode .time {
    color: #bbb;
  }
  .mode-toggle {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #007bff;
    color: white;
    border: none;
    padding: 10px 14px;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 3px 6px rgba(0,0,0,0.2);
  }
  #upload-container {
  width: 420px;
  margin: 20px auto;
  border: 2px solid #3498db;
  padding: 15px;
  border-radius: 10px;
  font-family: "Noto Sans", sans-serif;
  background: #f4f9ff;
}
#upload-container h2 {
  text-align: center;
  color: #2980b9;
  margin-bottom: 20px;
}
#json-input {
  width: 100%;
  height: 180px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-family: monospace;
  font-size: 14px;
  padding: 10px;
  resize: vertical;
}
#btn-upload {
  width: 100%;
  background: #2980b9;
  color: white;
  border: none;
  padding: 12px 0;
  margin-top: 12px;
  font-weight: 600;
  font-size: 16px;
  border-radius: 6px;
  cursor: pointer;
}
#btn-upload:hover {
  background: #1c5980;
}
#message {
  margin-top: 15px;
  font-weight: 600;
  text-align: center;
}
#user-div {
  background: #d0e7f9;
  padding: 10px;
  margin-bottom: 8px;
  border-radius: 6px;
  color: #1b4f72;
}
#ai_bhai-div {
  background: #d9f2d9;
  padding: 10px;
  margin-bottom: 12px;
  border-radius: 6px;
  color: #196f3d;
}
#json-list-div {
  border: 1px dashed #aaa;
  padding: 12px;
  max-height: 260px;
  overflow-y: auto;
  font-size: 14px;
  font-family: monospace;
  background: #eef8ff;
}
</style>
</head>
<body>

<header>📢 Live User Messages</header>
<div class="container" id="messagesContainer">
  लोड हो रहा है...
</div>
<div id="upload-container">
  <h2>AI Bhai Reply JSON Upload (Live API)</h2>
  
  <textarea id="json-input" placeholder='यहाँ JSON पेस्ट करें'></textarea>
  
  <button id="btn-upload">अपलोड करें</button>
  
  <div id="message"></div>
  
  <div id="json-list-div"></div>
</div>
<button class="mode-toggle" onclick="toggleMode()">🌙</button>

<script>
const messagesContainer = document.getElementById('messagesContainer');
let darkMode = false;

async function fetchMessages() {
  try {
    const response = await fetch("https://deepakchauhanxai.xyz/user_messages.json?nocache=" + Date.now());
    const data = await response.json();

    messagesContainer.innerHTML = "";
    data.forEach(msg => {
      const div = document.createElement('div');
      div.classList.add('message');
      div.innerHTML = `
        <div><strong>${msg.user || "Unknown User"}</strong></div>
        <div>${msg.message}</div>
        <div class="time">${msg.time || ""}</div>
      `;
      messagesContainer.appendChild(div);
    });
  } catch (err) {
    messagesContainer.innerHTML = "❌ डेटा लोड करने में समस्या";
  }
}

function toggleMode() {
  darkMode = !darkMode;
  document.body.classList.toggle('dark-mode', darkMode);
  document.querySelector('.mode-toggle').textContent = darkMode ? "☀️" : "🌙";
}

setInterval(fetchMessages, 3000);
fetchMessages();

const input = document.getElementById("json-input");
const btn = document.getElementById("btn-upload");
const msg = document.getElementById("message");
const listDiv = document.getElementById("json-list-div");

btn.onclick = async () => {
  msg.textContent = "";
  listDiv.innerHTML = "";
  let jsonStr = input.value.trim();
  if (!jsonStr) {
    msg.style.color = "red";
    msg.textContent = "JSON डाटा पेस्ट करें।";
    return;
  }
  try {
    const data = JSON.parse(jsonStr);

    const resp = await fetch("https://deepakchauhanxai.xyz/upload_ai_bhai_json.php", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(data)
    });

    const result = await resp.json();

    if (result.status === "success") {
      msg.style.color = "green";
      msg.textContent = "JSON सफलतापूर्वक अपलोड हो गया!";
      showJsonList(data);
    } else {
      msg.style.color = "red";
      msg.textContent = "अपलोड में त्रुटि: " + result.message;
    }
  } catch (e) {
    msg.style.color = "red";
    msg.textContent = "अमान्य JSON: " + e.message;
  }
};

function showJsonList(data) {
  listDiv.innerHTML = "";
  data.forEach(item => {
    const userDiv = document.createElement("div");
    userDiv.id = "user-div";
    userDiv.textContent = "User: " + item.user;

    const aiDiv = document.createElement("div");
    aiDiv.id = "ai_bhai-div";
    aiDiv.textContent = "AI Bhai: " + item.ai_bhai;

    listDiv.appendChild(userDiv);
    listDiv.appendChild(aiDiv);
  });
}
</script>
</body>
</html>
